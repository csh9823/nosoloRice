<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

		<!-- 한선  -->

<mapper namespace="com.nosolorice.app.mapper.AdminPageMapper">

	
	<select id="reportList" resultType="ReportDetails" resultMap="reportResultMap">
	
	SELECT * FROM report_details ORDER BY report_no
	
	</select>
	
	<select id="getReportCount" resultType="int" parameterType="ReportDetails">
	
		SELECT COUNT(report_no) FROM report_details
		
	</select>
	

	<select id="reviewList" resultType="Review" resultMap="reviewResultMap">
	
	SELECT * FROM review ORDER BY review_no
	
	</select>

	
	<select id="deniedList" resultType="DeniedUser" resultMap="deniedResultMap">
	
	SELECT * FROM denied_user ORDER BY denied_user_no DESC
	
	</select>
	
	<select id="searchId" resultType="String">
    
    <![CDATA[
    SELECT normal_id
    FROM normal_user
    WHERE normal_id = #{id} AND NOT EXISTS (
        SELECT 1 FROM denied_user WHERE normal_id = #{id}
    )
    ]]>

</select>

<insert id="addDenied" parameterType="hashmap">
    <![CDATA[
    INSERT INTO denied_user 
    VALUES (null, #{id}, #{reason}, NOW(), DATE_ADD(NOW(), INTERVAL #{day} DAY))
    ]]>
</insert>



<select id="businessDelete" resultType="BusinessUser">

	SELECT name, phone, business_name as businessName, business_profile as businessProfile, address1, address2  FROM  business_user
	
</select>


<delete id="unlockUser" parameterType="int">

	DELETE FROM denied_user WHERE denied_user_no = #{deniedUserNo}

</delete>



	
		<!-- 신고 리스트 -->
	<resultMap id="reportResultMap" type="ReportDetails">
		<id property="reportNo" column="report_no"/>
		<result property="reportContent" column="report_content"/>
		<result property="reportPicture" column="report_picture"/>
		<result property="reportReporter" column="report_reporter"/>
		<result property="reportAttacker" column="report_attacker"/>
		<result property="reportRegDate" column="report_regdate"/>
	</resultMap>
	
		<!-- 리뷰 리스트 -->
	<resultMap id="reviewResultMap" type="Review">
		<id property="reviewNo" column="review_no"/>
		<result property="reviewContent" column="review_content"/>
		<result property="reviewPicture" column="review_picture"/>
		<result property="reviewScore" column="review_score"/>
		<result property="regDate" column="regdate"/>
		<result property="reviewBlind" column="review_blind"/>
		<result property="reviewDelete" column="review_delete"/>
		<result property="normalId" column="normal_id"/>
		<result property="businessId" column="business_id"/>
		<result property="bookingOkNo" column="bookingok_no"/>	
	</resultMap>
	
		<!--  정지 리스트 -->
		<resultMap id="deniedResultMap" type="DeniedUser">
			<id property="deniedUserNo" column="denied_user_no"/>
			<result property="normalId" column="normal_id"/>
			<result property="deniedReason" column="denied_reason"/>
			<result property="deniedRegDate" column="denied_regdate"/>
			<result property="deniedUnlock" column="denied_unlock"/>
		</resultMap>
		

</mapper>


